#! /usr/bin/python
	"""Automated external network penetration tool.

	Created to automate the first five steps of a external 
	network penetration test. Will use nmap to scan all 
	ports, followed by Nikto, SSlscan, banner grabbing and 
	directory enumeration with dirb.

	In the future this tool will have options to adhere to 
	testing windows and will pause until the testing window 
	has been reached.
	"""	

import nmapam
import optparse

__author__ = "PhoenixB1rd","ScriptAutomate"
__credits__ = "PhoenixB1rd", "ScriptAutomate"
__version__ = "1.0.1"
__maintainer__ = "PhoenixB1rd"
__email_ = "PhoenixB1rd@users.noreply.github.com"

# Step one, Nmap scan on all ports with a -A parameter.

def nmapScan(tgtHost, tgtPort=None):

	if tgtPort == None:
		tgtPort = '-'

	nmScan = nmap.PortScanner()
	nmScan.scan(hosts=tgtHost, arguments='-Pn -A -p'+tgtPort)
	state=nmScan[tgtHost]['tcp'][int(tgtPort)]['state']
	print " [*} " + tgtHost + " tcp/"+tgtPort + " "+state

# Step two, using the results from Nmap will start SSLscan with
# any ports that displayed http/https/SSL.

def sslScanUtil():
	pass

# Step three, start Nikto utilizing the same list of http/https

def niktoScan():
	pass

# Step four, grab banners from all the ports that displayed 
# as being "open".

def bannerGrabber():
	pass

# Definine the testing window to adhere to ex. 9am - 5pm

def timeRestraints():
	pass

# Future functionality: Accumulate the results into an easy
# to read document. But also displays results in real-time.

def documentCreater():
	pass

# Finally, the main function that orchestrates all the steps.

def main():
	parser = optparse.OptionParser('usage%prog ' +\
		'-H <target host> -p <target port>')
	parser.add_option('-H', dest='tgtHost', type='string', \
		help='specify target host')
	parser.add_option('-p', dest='tgtPort', type='integer', \
		help='specify target port[s] seperated by a comma')
	(options, args) = parser.parse_args()
	tgtHost = options.tgtHost
	tgtPorts = str(options,tgtPort).split(', ')

	if (tgtHost == None) | (tgtPorts[0] == None):
		print parser.useage
		exit(0)

	for tgtPort in tgtPorts:
		nmapScan(tgtHost, tgtPort)

if __name__=='__main__':
	main()